<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéµ Player 8 Decks Avan√ßado - Face a Face com Deus</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- HTML5 Audio API nativa - maior compatibilidade -->
    
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .player-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin: 20px;
            padding: 30px;
        }
        
        .deck-container {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .deck-container.active {
            border-color: var(--success-color);
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }
        
        .deck-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-label {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 8px;
        }
        
        .volume-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ddd 0%, var(--success-color) 0%);
            outline: none;
            transition: all 0.3s;
        }
        
        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--success-color);
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .play-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 24px;
            transition: all 0.3s ease;
            margin: 10px;
        }
        
        .play-button.playing {
            background: var(--success-color);
            color: white;
            animation: pulse 2s infinite;
        }
        
        .play-button:not(.playing) {
            background: var(--light-color);
            color: var(--dark-color);
            border: 2px solid var(--primary-color);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .crossfader-container {
            background: linear-gradient(145deg, #2c3e50, #34495e);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }
        
        .crossfader {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(to right, var(--primary-color), transparent, var(--secondary-color));
            outline: none;
            margin: 15px 0;
        }
        
        .crossfader::-webkit-slider-thumb {
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .progress-bar-container {
            background: #ddd;
            border-radius: 10px;
            height: 8px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--info-color));
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .file-input-container {
            position: relative;
            margin: 15px 0;
        }
        
        .file-input {
            display: none;
        }
        
        .file-input-label {
            display: block;
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--info-color), #138496);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            border: none;
            font-weight: 500;
        }
        
        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .current-track {
            background: var(--light-color);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9em;
            color: var(--dark-color);
            border-left: 4px solid var(--success-color);
        }
        
        .automix-panel {
            background: linear-gradient(145deg, #ff6b6b, #ee5a52);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }
        
        .automix-button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .automix-button:hover, .automix-button.active {
            background: white;
            color: #ff6b6b;
        }
        
        .master-controls {
            background: linear-gradient(145deg, var(--dark-color), #495057);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .eq-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .eq-knob {
            text-align: center;
        }
        
        .eq-knob input {
            width: 100%;
            margin: 10px 0;
        }
        
        .waveform-container {
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }
        
        .waveform {
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                rgba(255, 255, 255, 0.1) 0px,
                rgba(255, 255, 255, 0.3) 2px,
                rgba(255, 255, 255, 0.1) 4px,
                rgba(255, 255, 255, 0.1) 8px
            );
            animation: waveform-animation 2s linear infinite;
        }
        
        @keyframes waveform-animation {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .deck-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .deck-button {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .loop-button { background: var(--warning-color); color: white; }
        .cue-button { background: var(--info-color); color: white; }
        .sync-button { background: var(--success-color); color: white; }
        .fx-button { background: var(--danger-color); color: white; }
        
        .deck-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .bpm-display {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            color: var(--dark-color);
            margin: 10px 0;
        }
        
        .status-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--success-color);
            box-shadow: 0 0 10px var(--success-color);
        }
        
        .status-indicator.inactive {
            background: #ccc;
            box-shadow: none;
        }

        /* Estilos da Playlist */
        .playlist-item {
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0 !important;
        }

        .playlist-item:hover {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef) !important;
            border-color: #007bff !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);
        }

        .playlist-item.bg-light {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
            border-color: #2196f3 !important;
        }

        .playlist-item .btn-group .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        .playlist-item .badge {
            font-size: 0.7rem;
            padding: 0.25em 0.5em;
        }

        .card-header h6 {
            margin-bottom: 0;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="text-center mb-4">
                        <h1 class="mb-0">üéµ Player Profissional 8 Decks</h1>
                        <p class="text-muted">Face a Face com Deus - Sistema de √Åudio Ministerial Avan√ßado</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decks Row 1 -->
        <div class="row">
            <!-- Deck 1 -->
            <div class="col-lg-6">
                <div class="player-container">
                    <div class="deck-container" id="deck1">
                        <div class="status-indicator" id="status1"></div>
                        <div class="deck-header">
                            <i class="fas fa-music me-2"></i>DECK 1 - LOUVOR
                        </div>
                        
                        <div class="file-input-container">
                            <input type="file" class="file-input" id="file1" accept="audio/*">
                            <label for="file1" class="file-input-label">
                                <i class="fas fa-upload me-2"></i>Carregar M√∫sica
                            </label>
                        </div>
                        
                        <div class="current-track" id="track1">
                            <i class="fas fa-music me-2"></i>Nenhuma m√∫sica carregada
                        </div>
                        
                        <div class="waveform-container">
                            <div class="waveform" id="waveform1"></div>
                        </div>
                        
                        <div class="text-center">
                            <button class="play-button" id="play1">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress1"></div>
                        </div>
                        
                        <div class="time-display">
                            <span id="currentTime1">0:00</span>
                            <span id="duration1">0:00</span>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Volume</div>
                            <input type="range" class="volume-slider" id="volume1" min="0" max="100" value="70">
                            <div class="text-center mt-2">
                                <span id="volumeDisplay1">70%</span>
                            </div>
                        </div>
                        
                        <div class="deck-controls">
                            <button class="deck-button loop-button" id="loop1">
                                <i class="fas fa-redo me-1"></i>LOOP
                            </button>
                            <button class="deck-button cue-button" id="cue1">
                                <i class="fas fa-step-backward me-1"></i>CUE
                            </button>
                            <button class="deck-button sync-button" id="sync1">
                                <i class="fas fa-sync me-1"></i>SYNC
                            </button>
                            <button class="deck-button fx-button" id="fx1">
                                <i class="fas fa-magic me-1"></i>FX
                            </button>
                        </div>
                        
                        <div class="bpm-display">
                            <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm1">120</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Deck 2 -->
            <div class="col-lg-6">
                <div class="player-container">
                    <div class="deck-container" id="deck2">
                        <div class="status-indicator inactive" id="status2"></div>
                        <div class="deck-header">
                            <i class="fas fa-music me-2"></i>DECK 2 - ADORA√á√ÉO
                        </div>
                        
                        <div class="file-input-container">
                            <input type="file" class="file-input" id="file2" accept="audio/*">
                            <label for="file2" class="file-input-label">
                                <i class="fas fa-upload me-2"></i>Carregar M√∫sica
                            </label>
                        </div>
                        
                        <div class="current-track" id="track2">
                            <i class="fas fa-music me-2"></i>Nenhuma m√∫sica carregada
                        </div>
                        
                        <div class="waveform-container">
                            <div class="waveform" id="waveform2"></div>
                        </div>
                        
                        <div class="text-center">
                            <button class="play-button" id="play2">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress2"></div>
                        </div>
                        
                        <div class="time-display">
                            <span id="currentTime2">0:00</span>
                            <span id="duration2">0:00</span>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Volume</div>
                            <input type="range" class="volume-slider" id="volume2" min="0" max="100" value="70">
                            <div class="text-center mt-2">
                                <span id="volumeDisplay2">70%</span>
                            </div>
                        </div>
                        
                        <div class="deck-controls">
                            <button class="deck-button loop-button" id="loop2">
                                <i class="fas fa-redo me-1"></i>LOOP
                            </button>
                            <button class="deck-button cue-button" id="cue2">
                                <i class="fas fa-step-backward me-1"></i>CUE
                            </button>
                            <button class="deck-button sync-button" id="sync2">
                                <i class="fas fa-sync me-1"></i>SYNC
                            </button>
                            <button class="deck-button fx-button" id="fx2">
                                <i class="fas fa-magic me-1"></i>FX
                            </button>
                        </div>
                        
                        <div class="bpm-display">
                            <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm2">120</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Crossfader A/B -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="crossfader-container">
                        <h4><i class="fas fa-sliders-h me-2"></i>Crossfader A ‚Üî B</h4>
                        <p class="mb-3">Transi√ß√£o suave entre Deck 1 e Deck 2</p>
                        <input type="range" class="crossfader" id="crossfaderAB" min="0" max="100" value="50">
                        <div class="d-flex justify-content-between mt-2">
                            <span><strong>A - DECK 1</strong></span>
                            <span>CENTRO</span>
                            <span><strong>B - DECK 2</strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decks Row 2 -->
        <div class="row">
            <!-- Deck 3 -->
            <div class="col-lg-6">
                <div class="player-container">
                    <div class="deck-container" id="deck3">
                        <div class="status-indicator inactive" id="status3"></div>
                        <div class="deck-header">
                            <i class="fas fa-music me-2"></i>DECK 3 - MINISTRA√á√ÉO
                        </div>
                        
                        <div class="file-input-container">
                            <input type="file" class="file-input" id="file3" accept="audio/*">
                            <label for="file3" class="file-input-label">
                                <i class="fas fa-upload me-2"></i>Carregar M√∫sica
                            </label>
                        </div>
                        
                        <div class="current-track" id="track3">
                            <i class="fas fa-music me-2"></i>Nenhuma m√∫sica carregada
                        </div>
                        
                        <div class="waveform-container">
                            <div class="waveform" id="waveform3"></div>
                        </div>
                        
                        <div class="text-center">
                            <button class="play-button" id="play3">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress3"></div>
                        </div>
                        
                        <div class="time-display">
                            <span id="currentTime3">0:00</span>
                            <span id="duration3">0:00</span>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Volume</div>
                            <input type="range" class="volume-slider" id="volume3" min="0" max="100" value="70">
                            <div class="text-center mt-2">
                                <span id="volumeDisplay3">70%</span>
                            </div>
                        </div>
                        
                        <div class="deck-controls">
                            <button class="deck-button loop-button" id="loop3">
                                <i class="fas fa-redo me-1"></i>LOOP
                            </button>
                            <button class="deck-button cue-button" id="cue3">
                                <i class="fas fa-step-backward me-1"></i>CUE
                            </button>
                            <button class="deck-button sync-button" id="sync3">
                                <i class="fas fa-sync me-1"></i>SYNC
                            </button>
                            <button class="deck-button fx-button" id="fx3">
                                <i class="fas fa-magic me-1"></i>FX
                            </button>
                        </div>
                        
                        <div class="bpm-display">
                            <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm3">120</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Deck 4 -->
            <div class="col-lg-6">
                <div class="player-container">
                    <div class="deck-container" id="deck4">
                        <div class="status-indicator inactive" id="status4"></div>
                        <div class="deck-header">
                            <i class="fas fa-music me-2"></i>DECK 4 - FUNDO MUSICAL
                        </div>
                        
                        <div class="file-input-container">
                            <input type="file" class="file-input" id="file4" accept="audio/*">
                            <label for="file4" class="file-input-label">
                                <i class="fas fa-upload me-2"></i>Carregar M√∫sica
                            </label>
                        </div>
                        
                        <div class="current-track" id="track4">
                            <i class="fas fa-music me-2"></i>Nenhuma m√∫sica carregada
                        </div>
                        
                        <div class="waveform-container">
                            <div class="waveform" id="waveform4"></div>
                        </div>
                        
                        <div class="text-center">
                            <button class="play-button" id="play4">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress4"></div>
                        </div>
                        
                        <div class="time-display">
                            <span id="currentTime4">0:00</span>
                            <span id="duration4">0:00</span>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Volume</div>
                            <input type="range" class="volume-slider" id="volume4" min="0" max="100" value="70">
                            <div class="text-center mt-2">
                                <span id="volumeDisplay4">70%</span>
                            </div>
                        </div>
                        
                        <div class="deck-controls">
                            <button class="deck-button loop-button" id="loop4">
                                <i class="fas fa-redo me-1"></i>LOOP
                            </button>
                            <button class="deck-button cue-button" id="cue4">
                                <i class="fas fa-step-backward me-1"></i>CUE
                            </button>
                            <button class="deck-button sync-button" id="sync4">
                                <i class="fas fa-sync me-1"></i>SYNC
                            </button>
                            <button class="deck-button fx-button" id="fx4">
                                <i class="fas fa-magic me-1"></i>FX
                            </button>
                        </div>
                        
                        <div class="bpm-display">
                            <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm4">120</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decks Extras 5-8 -->
        <div class="row">
            <!-- Deck 5 -->
            <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12">
                <div class="deck-container">
                    <div class="deck-header">
                        <h4><i class="fas fa-record-vinyl me-2"></i>DECK 5</h4>
                        <div class="deck-status" id="status5">VAZIO</div>
                    </div>
                    
                    <div class="track-info">
                        <div class="track-title" id="title5">Nenhuma m√∫sica carregada</div>
                        <div class="track-artist" id="artist5">Selecione um arquivo</div>
                        <div class="track-time">
                            <span id="current5">00:00</span> / <span id="duration5">00:00</span>
                        </div>
                    </div>
                    
                    <div class="waveform-container">
                        <canvas class="waveform" id="waveform5" width="300" height="60"></canvas>
                        <div class="progress-overlay" id="progress5"></div>
                    </div>
                    
                    <div class="deck-controls mb-3">
                        <input type="file" class="file-input" id="file5" accept="audio/*">
                        <label for="file5" class="file-label">
                            <i class="fas fa-folder-open me-2"></i>Carregar M√∫sica
                        </label>
                    </div>
                    
                    <div class="main-controls">
                        <button class="play-button" id="play5">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="stop-button" id="stop5">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                    
                    <div class="volume-control">
                        <div class="control-label">VOLUME</div>
                        <input type="range" class="volume-slider" id="volume5" min="0" max="1" step="0.01" value="0.7">
                        <div class="volume-display"><span id="volumeDisplay5">70%</span></div>
                    </div>
                    
                    <div class="deck-controls">
                        <button class="deck-button loop-button" id="loop5">
                            <i class="fas fa-redo me-1"></i>LOOP
                        </button>
                        <button class="deck-button cue-button" id="cue5">
                            <i class="fas fa-step-backward me-1"></i>CUE
                        </button>
                        <button class="deck-button sync-button" id="sync5">
                            <i class="fas fa-sync me-1"></i>SYNC
                        </button>
                        <button class="deck-button fx-button" id="fx5">
                            <i class="fas fa-magic me-1"></i>FX
                        </button>
                    </div>
                    
                    <div class="bpm-display">
                        <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm5">120</span>
                    </div>
                </div>
            </div>

            <!-- Deck 6 -->
            <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12">
                <div class="deck-container">
                    <div class="deck-header">
                        <h4><i class="fas fa-record-vinyl me-2"></i>DECK 6</h4>
                        <div class="deck-status" id="status6">VAZIO</div>
                    </div>
                    
                    <div class="track-info">
                        <div class="track-title" id="title6">Nenhuma m√∫sica carregada</div>
                        <div class="track-artist" id="artist6">Selecione um arquivo</div>
                        <div class="track-time">
                            <span id="current6">00:00</span> / <span id="duration6">00:00</span>
                        </div>
                    </div>
                    
                    <div class="waveform-container">
                        <canvas class="waveform" id="waveform6" width="300" height="60"></canvas>
                        <div class="progress-overlay" id="progress6"></div>
                    </div>
                    
                    <div class="deck-controls mb-3">
                        <input type="file" class="file-input" id="file6" accept="audio/*">
                        <label for="file6" class="file-label">
                            <i class="fas fa-folder-open me-2"></i>Carregar M√∫sica
                        </label>
                    </div>
                    
                    <div class="main-controls">
                        <button class="play-button" id="play6">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="stop-button" id="stop6">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                    
                    <div class="volume-control">
                        <div class="control-label">VOLUME</div>
                        <input type="range" class="volume-slider" id="volume6" min="0" max="1" step="0.01" value="0.7">
                        <div class="volume-display"><span id="volumeDisplay6">70%</span></div>
                    </div>
                    
                    <div class="deck-controls">
                        <button class="deck-button loop-button" id="loop6">
                            <i class="fas fa-redo me-1"></i>LOOP
                        </button>
                        <button class="deck-button cue-button" id="cue6">
                            <i class="fas fa-step-backward me-1"></i>CUE
                        </button>
                        <button class="deck-button sync-button" id="sync6">
                            <i class="fas fa-sync me-1"></i>SYNC
                        </button>
                        <button class="deck-button fx-button" id="fx6">
                            <i class="fas fa-magic me-1"></i>FX
                        </button>
                    </div>
                    
                    <div class="bpm-display">
                        <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm6">120</span>
                    </div>
                </div>
            </div>

            <!-- Deck 7 -->
            <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12">
                <div class="deck-container">
                    <div class="deck-header">
                        <h4><i class="fas fa-record-vinyl me-2"></i>DECK 7</h4>
                        <div class="deck-status" id="status7">VAZIO</div>
                    </div>
                    
                    <div class="track-info">
                        <div class="track-title" id="title7">Nenhuma m√∫sica carregada</div>
                        <div class="track-artist" id="artist7">Selecione um arquivo</div>
                        <div class="track-time">
                            <span id="current7">00:00</span> / <span id="duration7">00:00</span>
                        </div>
                    </div>
                    
                    <div class="waveform-container">
                        <canvas class="waveform" id="waveform7" width="300" height="60"></canvas>
                        <div class="progress-overlay" id="progress7"></div>
                    </div>
                    
                    <div class="deck-controls mb-3">
                        <input type="file" class="file-input" id="file7" accept="audio/*">
                        <label for="file7" class="file-label">
                            <i class="fas fa-folder-open me-2"></i>Carregar M√∫sica
                        </label>
                    </div>
                    
                    <div class="main-controls">
                        <button class="play-button" id="play7">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="stop-button" id="stop7">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                    
                    <div class="volume-control">
                        <div class="control-label">VOLUME</div>
                        <input type="range" class="volume-slider" id="volume7" min="0" max="1" step="0.01" value="0.7">
                        <div class="volume-display"><span id="volumeDisplay7">70%</span></div>
                    </div>
                    
                    <div class="deck-controls">
                        <button class="deck-button loop-button" id="loop7">
                            <i class="fas fa-redo me-1"></i>LOOP
                        </button>
                        <button class="deck-button cue-button" id="cue7">
                            <i class="fas fa-step-backward me-1"></i>CUE
                        </button>
                        <button class="deck-button sync-button" id="sync7">
                            <i class="fas fa-sync me-1"></i>SYNC
                        </button>
                        <button class="deck-button fx-button" id="fx7">
                            <i class="fas fa-magic me-1"></i>FX
                        </button>
                    </div>
                    
                    <div class="bpm-display">
                        <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm7">120</span>
                    </div>
                </div>
            </div>

            <!-- Deck 8 -->
            <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12">
                <div class="deck-container">
                    <div class="deck-header">
                        <h4><i class="fas fa-record-vinyl me-2"></i>DECK 8</h4>
                        <div class="deck-status" id="status8">VAZIO</div>
                    </div>
                    
                    <div class="track-info">
                        <div class="track-title" id="title8">Nenhuma m√∫sica carregada</div>
                        <div class="track-artist" id="artist8">Selecione um arquivo</div>
                        <div class="track-time">
                            <span id="current8">00:00</span> / <span id="duration8">00:00</span>
                        </div>
                    </div>
                    
                    <div class="waveform-container">
                        <canvas class="waveform" id="waveform8" width="300" height="60"></canvas>
                        <div class="progress-overlay" id="progress8"></div>
                    </div>
                    
                    <div class="deck-controls mb-3">
                        <input type="file" class="file-input" id="file8" accept="audio/*">
                        <label for="file8" class="file-label">
                            <i class="fas fa-folder-open me-2"></i>Carregar M√∫sica
                        </label>
                    </div>
                    
                    <div class="main-controls">
                        <button class="play-button" id="play8">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="stop-button" id="stop8">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                    
                    <div class="volume-control">
                        <div class="control-label">VOLUME</div>
                        <input type="range" class="volume-slider" id="volume8" min="0" max="1" step="0.01" value="0.7">
                        <div class="volume-display"><span id="volumeDisplay8">70%</span></div>
                    </div>
                    
                    <div class="deck-controls">
                        <button class="deck-button loop-button" id="loop8">
                            <i class="fas fa-redo me-1"></i>LOOP
                        </button>
                        <button class="deck-button cue-button" id="cue8">
                            <i class="fas fa-step-backward me-1"></i>CUE
                        </button>
                        <button class="deck-button sync-button" id="sync8">
                            <i class="fas fa-sync me-1"></i>SYNC
                        </button>
                        <button class="deck-button fx-button" id="fx8">
                            <i class="fas fa-magic me-1"></i>FX
                        </button>
                    </div>
                    
                    <div class="bpm-display">
                        <i class="fas fa-heartbeat me-2"></i>BPM: <span id="bpm8">120</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Crossfader C/D -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="crossfader-container">
                        <h4><i class="fas fa-sliders-h me-2"></i>Crossfader C ‚Üî D</h4>
                        <p class="mb-3">Transi√ß√£o suave entre Deck 3 e Deck 4</p>
                        <input type="range" class="crossfader" id="crossfaderCD" min="0" max="100" value="50">
                        <div class="d-flex justify-content-between mt-2">
                            <span><strong>C - DECK 3</strong></span>
                            <span>CENTRO</span>
                            <span><strong>D - DECK 4</strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sistema AutoMix -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="automix-panel">
                        <h3><i class="fas fa-robot me-2"></i>Sistema AutoMix Inteligente</h3>
                        <p class="mb-4">Transi√ß√µes autom√°ticas baseadas em BPM e harmonia musical</p>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <button class="automix-button w-100" id="automixToggle">
                                    <i class="fas fa-magic me-2"></i>Ativar AutoMix
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="automix-button w-100" id="beatSync">
                                    <i class="fas fa-heartbeat me-2"></i>Sync BPM
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="automix-button w-100" id="harmonicMix">
                                    <i class="fas fa-music me-2"></i>Mix Harm√¥nico
                                </button>
                            </div>
                            <div class="col-md-3">
                                <button class="automix-button w-100" id="fadeMode">
                                    <i class="fas fa-adjust me-2"></i>Fade Suave
                                </button>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <div class="control-group">
                                <div class="control-label text-white">Tempo de Transi√ß√£o (segundos)</div>
                                <input type="range" class="volume-slider" id="transitionTime" min="3" max="30" value="8">
                                <div class="text-center mt-2">
                                    <span id="transitionDisplay">8s</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controles Master -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="master-controls">
                        <h3 class="text-center mb-4">
                            <i class="fas fa-sliders-h me-2"></i>Controles Master
                        </h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="control-group">
                                    <div class="control-label text-white">Volume Master</div>
                                    <input type="range" class="volume-slider" id="masterVolume" min="0" max="100" value="85">
                                    <div class="text-center mt-2">
                                        <span class="text-white" id="masterVolumeDisplay">85%</span>
                                    </div>
                                </div>
                                
                                <div class="eq-controls">
                                    <div class="eq-knob">
                                        <label class="text-white">GRAVES</label>
                                        <input type="range" id="bassEQ" min="-12" max="12" value="0">
                                        <span class="text-white" id="bassDisplay">0dB</span>
                                    </div>
                                    <div class="eq-knob">
                                        <label class="text-white">M√âDIOS</label>
                                        <input type="range" id="midEQ" min="-12" max="12" value="0">
                                        <span class="text-white" id="midDisplay">0dB</span>
                                    </div>
                                    <div class="eq-knob">
                                        <label class="text-white">AGUDOS</label>
                                        <input type="range" id="trebleEQ" min="-12" max="12" value="0">
                                        <span class="text-white" id="trebleDisplay">0dB</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="text-center">
                                    <h5 class="text-white mb-3">Status do Sistema</h5>
                                    <div class="row text-center">
                                        <div class="col-6">
                                            <div class="bg-success rounded p-2 mb-2">
                                                <i class="fas fa-check me-2"></i>Sistema Online
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-info rounded p-2 mb-2">
                                                <i class="fas fa-volume-up me-2"></i>√Åudio OK
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-warning rounded p-2">
                                                <i class="fas fa-clock me-2"></i><span id="systemTime">00:00</span>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="bg-primary rounded p-2">
                                                <i class="fas fa-users me-2"></i>Face a Face
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- √Årea de Teste -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="text-center mb-4">
                        <h4><i class="fas fa-vial me-2"></i>√Årea de Teste</h4>
                        <p class="text-muted">Use estas op√ß√µes para testar o player</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-microphone me-2"></i>Teste de √Åudio</h6>
                                </div>
                                <div class="card-body">
                                    <button class="btn btn-primary w-100 mb-2" onclick="testAudioContext()">
                                        <i class="fas fa-play me-2"></i>Testar Contexto de √Åudio
                                    </button>
                                    <button class="btn btn-success w-100 mb-2" onclick="generateTestTone(1)">
                                        <i class="fas fa-volume-up me-2"></i>Gerar Tom de Teste - Deck 1
                                    </button>
                                    <small class="text-muted">
                                        Use estes bot√µes para verificar se o √°udio est√° funcionando
                                    </small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-info-circle me-2"></i>Status do Sistema</h6>
                                </div>
                                <div class="card-body">
                                    <div id="systemStatus">
                                        <p><strong>Navegador:</strong> <span id="browserInfo">-</span></p>
                                        <p><strong>Suporte a √Åudio:</strong> <span id="audioSupport">-</span></p>
                                        <p><strong>Formatos Suportados:</strong></p>
                                        <div id="formatSupport"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="alert alert-info">
                                <h6><i class="fas fa-lightbulb me-2"></i>Dicas para Uso:</h6>
                                <ul class="mb-0 small">
                                    <li>Use arquivos MP3 ou WAV para melhor compatibilidade</li>
                                    <li>Clique em "Gerar Tom de Teste" primeiro para verificar o √°udio</li>
                                    <li>Certifique-se de que o navegador permite reprodu√ß√£o de √°udio</li>
                                    <li>Para usar em eventos, teste todas as funcionalidades antes</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="alert alert-success">
                                <h6><i class="fas fa-upload me-2"></i>Upload de M√∫sicas:</h6>
                                <ul class="mb-0 small">
                                    <li><strong>Formatos aceitos:</strong> MP3, WAV, OGG, AAC, FLAC</li>
                                    <li><strong>Nome do arquivo:</strong> "Artista - T√≠tulo.mp3" (recomendado)</li>
                                    <li><strong>Upload m√∫ltiplo:</strong> Selecione v√°rias m√∫sicas de uma vez</li>
                                    <li><strong>AutoMix:</strong> Configure intervalos e modo de reprodu√ß√£o</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sistema de Playlist AutoMix -->
        <div class="row">
            <div class="col-12">
                <div class="player-container">
                    <div class="text-center mb-4">
                        <h4><i class="fas fa-list-music me-2"></i>Playlist AutoMix (8 Decks)</h4>
                        <p class="text-muted">Sistema autom√°tico de reprodu√ß√£o de m√∫sicas para eventos</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h6 class="mb-0"><i class="fas fa-music me-2"></i>Suas M√∫sicas Personalizadas</h6>
                                        <span class="badge bg-primary" id="playlistCount">0 m√∫sicas</span>
                                    </div>
                                    <div class="d-flex flex-wrap gap-1">
                                        <button class="btn btn-sm btn-warning" onclick="uploadMultipleFiles()">
                                            <i class="fas fa-cloud-upload-alt me-1"></i>Upload M√∫ltiplo
                                        </button>
                                        <button class="btn btn-sm btn-success" onclick="loadPlaylist()">
                                            <i class="fas fa-refresh me-1"></i>Atualizar Lista
                                        </button>
                                        <button class="btn btn-sm btn-primary" onclick="addCustomTrack()">
                                            <i class="fas fa-plus me-1"></i>Adicionar Manual
                                        </button>
                                        <button class="btn btn-sm btn-secondary" onclick="clearPlaylist()">
                                            <i class="fas fa-trash me-1"></i>Limpar
                                        </button>
                                        <button class="btn btn-sm btn-info" onclick="testPlaylistIntegration()" title="Testar integra√ß√£o playlist ‚Üí decks">
                                            <i class="fas fa-bug me-1"></i>Teste
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                                    <div id="playlistContainer">
                                        <!-- Lista ser√° preenchida via JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-cog me-2"></i>Configura√ß√µes AutoMix</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-6">
                                            <label class="form-label">Tempo de Transi√ß√£o (s)</label>
                                            <input type="number" id="transitionTime" class="form-control" value="10" min="5" max="30">
                                        </div>
                                        <div class="col-6">
                                            <label class="form-label">Intervalo entre M√∫sicas (s)</label>
                                            <input type="number" id="intervalTime" class="form-control" value="30" min="10" max="300">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Modo de Reprodu√ß√£o</label>
                                        <select id="playbackMode" class="form-select">
                                            <option value="sequential">Sequencial</option>
                                            <option value="random">Aleat√≥rio</option>
                                            <option value="loop">Loop da Lista</option>
                                        </select>
                                    </div>
                                    
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-success flex-fill" onclick="startAutoMixPlaylist()" id="startAutoMixBtn">
                                            <i class="fas fa-play me-2"></i>Iniciar AutoMix
                                        </button>
                                        <button class="btn btn-danger flex-fill" onclick="stopAutoMixPlaylist()" id="stopAutoMixBtn" disabled>
                                            <i class="fas fa-stop me-2"></i>Parar AutoMix
                                        </button>
                                    </div>
                                    
                                    <div class="mt-3">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <small class="text-muted">Status:</small>
                                            <span id="autoMixStatus" class="badge bg-secondary">Parado</span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">Pr√≥xima m√∫sica:</small>
                                            <span id="nextTrack" class="text-muted">-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="row">
            <div class="col-12">
                <div class="player-container text-center">
                    <p class="mb-2">
                        <strong>Face a Face com Deus</strong> - Player Profissional 4 Decks
                    </p>
                    <p class="text-muted mb-0">
                        <em>"Louvai-o com c√≠mbalos sonoros; louvai-o com c√≠mbalos retumbantes." - Salmos 150:5</em>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Player JavaScript -->
    <script>
        class Deck {
            constructor(deckNumber) {
                this.deckNumber = deckNumber;
                this.audio = null;
                this.sound = null;
                this.isPlaying = false;
                this.isLooping = false;
                this.volume = 0.7;
                this.bpm = 120;
                this.cuePoint = 0;
                
                this.initializeElements();
                this.bindEvents();
            }
            
            initializeElements() {
                this.elements = {
                    fileInput: document.getElementById(`file${this.deckNumber}`),
                    playButton: document.getElementById(`play${this.deckNumber}`),
                    volumeSlider: document.getElementById(`volume${this.deckNumber}`),
                    volumeDisplay: document.getElementById(`volumeDisplay${this.deckNumber}`),
                    progressBar: document.getElementById(`progress${this.deckNumber}`),
                    currentTime: document.getElementById(`currentTime${this.deckNumber}`),
                    duration: document.getElementById(`duration${this.deckNumber}`),
                    trackInfo: document.getElementById(`track${this.deckNumber}`),
                    bpmDisplay: document.getElementById(`bpm${this.deckNumber}`),
                    statusIndicator: document.getElementById(`status${this.deckNumber}`),
                    deckContainer: document.getElementById(`deck${this.deckNumber}`),
                    loopButton: document.getElementById(`loop${this.deckNumber}`),
                    cueButton: document.getElementById(`cue${this.deckNumber}`),
                    syncButton: document.getElementById(`sync${this.deckNumber}`),
                    fxButton: document.getElementById(`fx${this.deckNumber}`)
                };
            }
            
            bindEvents() {
                // File input change
                this.elements.fileInput.addEventListener('change', (e) => this.loadFile(e));
                
                // Play/Pause button
                this.elements.playButton.addEventListener('click', () => this.togglePlay());
                
                // Volume slider
                this.elements.volumeSlider.addEventListener('input', (e) => this.setVolume(e.target.value));
                
                // Control buttons
                this.elements.loopButton.addEventListener('click', () => this.toggleLoop());
                this.elements.cueButton.addEventListener('click', () => this.setCue());
                this.elements.syncButton.addEventListener('click', () => this.syncBPM());
                this.elements.fxButton.addEventListener('click', () => this.toggleFX());
            }
            
            loadFile(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                // Verificar se √© um arquivo de √°udio
                if (!file.type.startsWith('audio/')) {
                    alert('Por favor, selecione um arquivo de √°udio v√°lido (MP3, WAV, etc.)');
                    return;
                }
                
                const url = URL.createObjectURL(file);
                
                // Usar elemento audio HTML5 nativo para maior compatibilidade
                if (this.audio) {
                    this.audio.pause();
                    this.audio.src = '';
                }
                
                this.audio = new Audio(url);
                this.audio.volume = this.volume;
                this.audio.loop = this.isLooping;
                this.audio.crossOrigin = "anonymous";
                
                // Event listeners para o √°udio
                this.audio.addEventListener('loadedmetadata', () => {
                    this.updateTrackInfo(file.name);
                    this.updateDuration();
                    this.elements.statusIndicator.classList.remove('inactive');
                    console.log(`Deck ${this.deckNumber}: M√∫sica carregada - ${file.name}`);
                });
                
                this.audio.addEventListener('play', () => {
                    this.isPlaying = true;
                    this.updatePlayButton();
                    this.elements.deckContainer.classList.add('active');
                    this.startProgressUpdate();
                    console.log(`Deck ${this.deckNumber}: Reprodu√ß√£o iniciada`);
                });
                
                this.audio.addEventListener('pause', () => {
                    this.isPlaying = false;
                    this.updatePlayButton();
                    this.elements.deckContainer.classList.remove('active');
                    console.log(`Deck ${this.deckNumber}: Reprodu√ß√£o pausada`);
                });
                
                this.audio.addEventListener('ended', () => {
                    if (!this.isLooping) {
                        this.isPlaying = false;
                        this.updatePlayButton();
                        this.elements.deckContainer.classList.remove('active');
                        this.elements.progressBar.style.width = '0%';
                        console.log(`Deck ${this.deckNumber}: Reprodu√ß√£o finalizada`);
                    }
                });
                
                this.audio.addEventListener('error', (e) => {
                    console.error(`Deck ${this.deckNumber}: Erro ao carregar √°udio:`, e);
                    alert(`Erro ao carregar o arquivo de √°udio no Deck ${this.deckNumber}`);
                });
                
                // Calcular BPM (simulado)
                this.bpm = Math.floor(Math.random() * 60) + 90; // 90-150 BPM
                this.elements.bpmDisplay.textContent = this.bpm;
            }
            
            togglePlay() {
                if (!this.audio) {
                    alert(`Primeiro carregue uma m√∫sica no Deck ${this.deckNumber}`);
                    return;
                }
                
                try {
                    if (this.isPlaying) {
                        this.audio.pause();
                    } else {
                        // Pausar outros decks se necess√°rio
                        const playPromise = this.audio.play();
                        if (playPromise !== undefined) {
                            playPromise.catch(error => {
                                console.error(`Deck ${this.deckNumber}: Erro ao reproduzir:`, error);
                                alert(`Erro ao reproduzir no Deck ${this.deckNumber}. Verifique o arquivo de √°udio.`);
                            });
                        }
                    }
                } catch (error) {
                    console.error(`Deck ${this.deckNumber}: Erro no toggle play:`, error);
                }
            }
            
            setVolume(value) {
                this.volume = value / 100;
                this.elements.volumeDisplay.textContent = `${value}%`;
                
                if (this.audio) {
                    this.audio.volume = this.volume;
                }
                
                // Atualizar gradiente do slider
                const percentage = value;
                this.elements.volumeSlider.style.background = 
                    `linear-gradient(to right, var(--success-color) 0%, var(--success-color) ${percentage}%, #ddd ${percentage}%, #ddd 100%)`;
            }
            
            toggleLoop() {
                this.isLooping = !this.isLooping;
                this.elements.loopButton.classList.toggle('active', this.isLooping);
                
                if (this.audio) {
                    this.audio.loop = this.isLooping;
                }
                
                showNotification(`Deck ${this.deckNumber}: Loop ${this.isLooping ? 'ativado' : 'desativado'}`);
            }
            
            setCue() {
                if (this.audio) {
                    this.cuePoint = this.audio.currentTime || 0;
                    this.elements.cueButton.classList.add('active');
                    setTimeout(() => this.elements.cueButton.classList.remove('active'), 200);
                    showNotification(`Deck ${this.deckNumber}: Cue point definido em ${this.formatTime(this.cuePoint)}`);
                }
            }
            
            syncBPM() {
                // Sincronizar BPM com outros decks (funcionalidade avan√ßada)
                this.elements.syncButton.classList.add('active');
                setTimeout(() => this.elements.syncButton.classList.remove('active'), 1000);
                
                // Notifica√ß√£o visual
                showNotification(`Deck ${this.deckNumber} sincronizado - BPM: ${this.bpm}`);
            }
            
            toggleFX() {
                // Toggle de efeitos (reverb, delay, etc.)
                this.elements.fxButton.classList.toggle('active');
            }
            
            updateTrackInfo(filename) {
                this.elements.trackInfo.innerHTML = 
                    `<i class="fas fa-music me-2"></i>${filename.substring(0, 30)}${filename.length > 30 ? '...' : ''}`;
            }
            
            updateDuration() {
                if (this.audio && this.audio.duration) {
                    const duration = this.audio.duration;
                    this.elements.duration.textContent = this.formatTime(duration);
                }
            }
            
            updatePlayButton() {
                const icon = this.elements.playButton.querySelector('i');
                if (this.isPlaying) {
                    icon.className = 'fas fa-pause';
                    this.elements.playButton.classList.add('playing');
                } else {
                    icon.className = 'fas fa-play';
                    this.elements.playButton.classList.remove('playing');
                }
            }
            
            startProgressUpdate() {
                if (this.progressInterval) {
                    clearInterval(this.progressInterval);
                }
                
                this.progressInterval = setInterval(() => {
                    if (this.audio && this.isPlaying && !this.audio.paused) {
                        const currentTime = this.audio.currentTime || 0;
                        const duration = this.audio.duration || 0;
                        
                        if (duration > 0) {
                            const progress = (currentTime / duration) * 100;
                            this.elements.progressBar.style.width = `${progress}%`;
                            this.elements.currentTime.textContent = this.formatTime(currentTime);
                        }
                    }
                }, 500);
            }
            
            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }
        }
        
        class CrossFader {
            constructor(faderId, leftDeck, rightDeck) {
                this.element = document.getElementById(faderId);
                this.leftDeck = leftDeck;
                this.rightDeck = rightDeck;
                
                this.element.addEventListener('input', (e) => this.handleCrossfade(e.target.value));
            }
            
            handleCrossfade(value) {
                const leftVolume = (100 - value) / 100;
                const rightVolume = value / 100;
                
                if (this.leftDeck && this.leftDeck.audio) {
                    this.leftDeck.audio.volume = this.leftDeck.volume * leftVolume;
                }
                
                if (this.rightDeck && this.rightDeck.audio) {
                    this.rightDeck.audio.volume = this.rightDeck.volume * rightVolume;
                }
            }
        }
        
        class AutoMix {
            constructor() {
                this.isActive = false;
                this.transitionTime = 8;
                
                this.bindEvents();
            }
            
            bindEvents() {
                document.getElementById('automixToggle').addEventListener('click', () => this.toggle());
                document.getElementById('beatSync').addEventListener('click', () => this.syncAllBPM());
                document.getElementById('harmonicMix').addEventListener('click', () => this.harmonicMixing());
                document.getElementById('fadeMode').addEventListener('click', () => this.toggleFadeMode());
                
                document.getElementById('transitionTime').addEventListener('input', (e) => {
                    this.transitionTime = e.target.value;
                    document.getElementById('transitionDisplay').textContent = `${e.target.value}s`;
                });
            }
            
            toggle() {
                this.isActive = !this.isActive;
                const button = document.getElementById('automixToggle');
                
                if (this.isActive) {
                    button.classList.add('active');
                    button.innerHTML = '<i class="fas fa-stop me-2"></i>Parar AutoMix';
                    showNotification('AutoMix ativado - Transi√ß√µes autom√°ticas iniciadas');
                } else {
                    button.classList.remove('active');
                    button.innerHTML = '<i class="fas fa-magic me-2"></i>Ativar AutoMix';
                    showNotification('AutoMix desativado');
                }
            }
            
            syncAllBPM() {
                showNotification('Sincronizando BPM de todos os decks...');
                // Implementar sincroniza√ß√£o de BPM
            }
            
            harmonicMixing() {
                showNotification('An√°lise harm√¥nica ativada - Mixagens mais suaves');
            }
            
            toggleFadeMode() {
                showNotification('Modo fade suave ativado');
            }
        }
        
        // Inicializar sistema
        document.addEventListener('DOMContentLoaded', () => {
            // SISTEMA DE PLAYLIST - VERS√ÉO FUNCIONAL
            let playlist = [];
            let autoMixPlaylistActive = false;
            let autoMixInterval = null;
            let currentPlaylistIndex = 0;
            let currentDeck = 1;

            // Criar os 8 decks
            const deck1 = new Deck(1);
            const deck2 = new Deck(2);
            const deck3 = new Deck(3);
            const deck4 = new Deck(4);
            const deck5 = new Deck(5);
            const deck6 = new Deck(6);
            const deck7 = new Deck(7);
            const deck8 = new Deck(8);
            
            // Criar crossfaders
            const crossfaderAB = new CrossFader('crossfaderAB', deck1, deck2);
            const crossfaderCD = new CrossFader('crossfaderCD', deck3, deck4);
            
            // Criar sistema AutoMix
            const autoMix = new AutoMix();
            
            // Controles Master
            setupMasterControls();
            
            // Atualizar rel√≥gio
            updateSystemTime();
            setInterval(updateSystemTime, 1000);
            
            // Inicializar volumes com gradiente
            [1, 2, 3, 4].forEach(i => {
                const slider = document.getElementById(`volume${i}`);
                const value = slider.value;
                slider.style.background = 
                    `linear-gradient(to right, var(--success-color) 0%, var(--success-color) ${value}%, #ddd ${value}%, #ddd 100%)`;
            });
        });
        
        function setupMasterControls() {
            // Volume Master
            document.getElementById('masterVolume').addEventListener('input', (e) => {
                document.getElementById('masterVolumeDisplay').textContent = `${e.target.value}%`;
            });
            
            // EQ Controls
            ['bass', 'mid', 'treble'].forEach(eq => {
                document.getElementById(`${eq}EQ`).addEventListener('input', (e) => {
                    document.getElementById(`${eq}Display`).textContent = `${e.target.value}dB`;
                });
            });
        }
        
        function updateSystemTime() {
            const now = new Date();
            const time = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('systemTime').textContent = time;
        }
        
        function showNotification(message) {
            // Criar notifica√ß√£o toast
            const toast = document.createElement('div');
            toast.className = 'position-fixed top-0 end-0 p-3';
            toast.style.zIndex = '9999';
            toast.innerHTML = `
                <div class="toast show" role="alert">
                    <div class="toast-header">
                        <i class="fas fa-music me-2 text-primary"></i>
                        <strong class="me-auto">Player 4 Decks</strong>
                        <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
                    </div>
                    <div class="toast-body">
                        ${message}
                    </div>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        // Atalhos de teclado
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case '1':
                    if (e.ctrlKey) document.getElementById('play1').click();
                    break;
                case '2':
                    if (e.ctrlKey) document.getElementById('play2').click();
                    break;
                case '3':
                    if (e.ctrlKey) document.getElementById('play3').click();
                    break;
                case '4':
                    if (e.ctrlKey) document.getElementById('play4').click();
                    break;
                case ' ':
                    e.preventDefault();
                    // Pausar/tocar deck ativo
                    break;
            }
        });
        
        // Prevenir perda de dados
        window.addEventListener('beforeunload', (e) => {
            const hasActiveSounds = [1, 2, 3, 4].some(i => {
                const deck = window[`deck${i}`];
                return deck && deck.sound && deck.isPlaying;
            });
            
            if (hasActiveSounds) {
                e.preventDefault();
                e.returnValue = 'Existem m√∫sicas tocando. Deseja realmente sair?';
            }
        });
        
        console.log('üéµ Player 8 Decks Avan√ßado - Face a Face com Deus inicializado com sucesso!');
        // FUN√á√ïES DA PLAYLIST - VERS√ÉO FUNCIONAL
        function loadPlaylist() {
            console.log('üéµ Carregando playlist...');
            renderPlaylist();
        }

        function renderPlaylist() {
            console.log('üîÑ Renderizando playlist com', playlist.length, 'm√∫sicas');
            const container = document.getElementById('playlistContainer');
            
            if (!container) {
                console.error('‚ùå Elemento playlistContainer n√£o encontrado!');
                return;
            }

            if (playlist.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4">
                        <i class="fas fa-music fa-3x text-muted mb-3"></i>
                        <h6 class="text-muted">Sua playlist est√° vazia</h6>
                        <p class="text-muted small mb-3">Adicione suas m√∫sicas favoritas para come√ßar</p>
                        <div class="d-flex flex-column gap-2">
                            <button class="btn btn-primary btn-sm" onclick="uploadMultipleFiles()">
                                <i class="fas fa-cloud-upload-alt me-2"></i>Upload de M√∫sicas
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="loadExamplePlaylist()">
                                <i class="fas fa-list me-2"></i>Carregar Lista de Exemplo
                            </button>
                        </div>
                    </div>
                `;
                updatePlaylistCount();
                return;
            }

            let html = '';
            playlist.forEach((track, index) => {
                const isLoaded = track.url && track.url !== '';
                const statusClass = isLoaded ? 'text-success' : 'text-muted';
                const statusIcon = isLoaded ? 'fas fa-check-circle' : 'fas fa-circle';
                const isExample = track.isExample ? '<span class="badge bg-info ms-2">Exemplo</span>' : '';
                const isCurrent = index === currentPlaylistIndex ? '<span class="badge bg-primary ms-2">Atual</span>' : '';
                
                html += `
                    <div class="playlist-item mb-2 p-2 border rounded ${index === currentPlaylistIndex ? 'bg-light' : ''}">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center mb-1">
                                    <i class="${statusIcon} ${statusClass} me-2"></i>
                                    <strong>${track.title}</strong>
                                    ${isCurrent}
                                    ${isExample}
                                </div>
                                <small class="text-muted d-block">
                                    ${track.artist} ‚Ä¢ ${track.genre} ‚Ä¢ ${track.duration}
                                </small>
                            </div>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary btn-sm" onclick="loadTrackToPlaylist(${index})" title="Carregar arquivo">
                                    <i class="fas fa-upload"></i>
                                </button>
                                <button class="btn btn-outline-success btn-sm" onclick="playTrackFromPlaylist(${index})" ${!isLoaded ? 'disabled' : ''} title="Reproduzir">
                                    <i class="fas fa-play"></i>
                                </button>
                                <button class="btn btn-outline-danger btn-sm" onclick="removeFromPlaylist(${index})" title="Remover">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updatePlaylistCount();
            console.log('‚úÖ Playlist renderizada com sucesso');
        }

        function updatePlaylistCount() {
            const countElement = document.getElementById('playlistCount');
            
            if (!countElement) {
                console.error('‚ùå Elemento playlistCount n√£o encontrado');
                return;
            }
            
            const loadedCount = playlist.filter(track => track.url && track.url !== '').length;
            const totalCount = playlist.length;
            
            if (totalCount === 0) {
                countElement.textContent = 'Vazia';
                countElement.className = 'badge bg-secondary';
            } else if (loadedCount === totalCount) {
                countElement.textContent = `${totalCount} m√∫sica${totalCount > 1 ? 's' : ''} (prontas)`;
                countElement.className = 'badge bg-success';
            } else {
                countElement.textContent = `${loadedCount}/${totalCount} carregada${loadedCount !== 1 ? 's' : ''}`;
                countElement.className = 'badge bg-warning';
            }
            
            console.log(`üìä Contador atualizado: ${loadedCount}/${totalCount}`);
        }

        function uploadMultipleFiles() {
            console.log('üéµ Iniciando upload m√∫ltiplo...');
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'audio/*';
            input.multiple = true;
            
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                console.log(`üìÅ ${files.length} arquivo(s) selecionado(s)`);
                
                if (files.length === 0) {
                    console.log('‚ùå Nenhum arquivo selecionado');
                    return;
                }
                
                let successCount = 0;
                
                files.forEach((file, index) => {
                    console.log(`üéß Processando: ${file.name} (${file.type})`);
                    
                    if (file.type.startsWith('audio/')) {
                        const fileName = file.name.replace(/\.[^/.]+$/, "");
                        const parts = fileName.split(' - ');
                        
                        let title, artist;
                        if (parts.length >= 2) {
                            artist = parts[0].trim();
                            title = parts.slice(1).join(' - ').trim();
                        } else {
                            title = fileName;
                            artist = 'Artista Desconhecido';
                        }
                        
                        const url = URL.createObjectURL(file);
                        
                        const trackData = {
                            id: Date.now() + index,
                            title: title,
                            artist: artist,
                            genre: 'Sua M√∫sica',
                            duration: '0:00',
                            url: url,
                            file: file,
                            isExample: false
                        };
                        
                        playlist.push(trackData);
                        successCount++;
                        
                        console.log(`‚úÖ Adicionada: ${title} - ${artist}`);
                        
                        // Obter dura√ß√£o do arquivo
                        const audio = new Audio(url);
                        audio.addEventListener('loadedmetadata', () => {
                            const minutes = Math.floor(audio.duration / 60);
                            const seconds = Math.floor(audio.duration % 60);
                            trackData.duration = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                            renderPlaylist();
                        });
                        
                        audio.addEventListener('error', (e) => {
                            console.error('‚ùå Erro ao carregar:', file.name, e);
                        });
                        
                        audio.load();
                    } else {
                        console.warn(`‚ùå Arquivo inv√°lido: ${file.name} (${file.type})`);
                    }
                });
                
                // Renderizar imediatamente
                renderPlaylist();
                
                // Feedback para o usu√°rio
                setTimeout(() => {
                    if (successCount > 0) {
                        alert(`‚úÖ ${successCount} m√∫sica(s) adicionada(s) com sucesso!`);
                        console.log(`üéâ Upload conclu√≠do: ${successCount} m√∫sicas adicionadas`);
                    } else {
                        alert('‚ùå Nenhum arquivo de √°udio v√°lido foi selecionado.');
                        console.log('‚ùå Nenhum arquivo v√°lido processado');
                    }
                }, 100);
            };
            
            input.click();
        }

        function addCustomTrack() {
            console.log('‚úèÔ∏è Adicionando m√∫sica manual...');
            
            const title = prompt('Digite o t√≠tulo da m√∫sica:');
            if (!title) {
                console.log('‚ùå Cancelado pelo usu√°rio');
                return;
            }
            
            const artist = prompt('Digite o nome do artista:') || 'Artista Desconhecido';
            const genre = prompt('Digite o g√™nero musical:') || 'Personalizado';
            
            const newTrack = {
                id: Date.now(),
                title: title,
                artist: artist,
                genre: genre,
                duration: '0:00',
                url: '',
                file: null,
                isExample: false
            };
            
            playlist.push(newTrack);
            renderPlaylist();
            updateAutoMixStatus();
            
            console.log(`‚úÖ M√∫sica adicionada: ${title} - ${artist}`);
            alert(`‚úÖ M√∫sica "${title}" adicionada √† playlist!`);
        }

        function loadExamplePlaylist() {
            console.log('üìã Carregando playlist de exemplo...');
            
            if (!confirm('Deseja carregar uma playlist de exemplo com m√∫sicas crist√£s populares?')) {
                console.log('‚ùå Cancelado pelo usu√°rio');
                return;
            }
            
            const exampleTracks = [
                { title: 'Amazing Grace', artist: 'Traditional', genre: 'Hino', duration: '4:15' },
                { title: 'Rude Cruz', artist: 'Hin√°rio Adventista', genre: 'Hino', duration: '4:30' },
                { title: 'Oceanos', artist: 'Hillsong United', genre: 'Contemporary', duration: '6:45' },
                { title: 'Como √© Grande o Meu Deus', artist: 'Hillsong', genre: 'Contemporary', duration: '5:20' },
                { title: 'Tua Gra√ßa me Basta', artist: 'Fernandinho', genre: 'Gospel', duration: '4:50' }
            ];
            
            exampleTracks.forEach((track, index) => {
                playlist.push({
                    id: Date.now() + index,
                    title: track.title,
                    artist: track.artist,
                    genre: track.genre,
                    duration: track.duration,
                    url: '',
                    file: null,
                    isExample: true
                });
            });
            
            renderPlaylist();
            updateAutoMixStatus();
            
            console.log(`‚úÖ ${exampleTracks.length} m√∫sicas de exemplo carregadas`);
            alert('‚úÖ Playlist de exemplo carregada! Use os bot√µes de upload para adicionar arquivos.');
        }

        function clearPlaylist() {
            console.log('üóëÔ∏è Limpando playlist...');
            
            if (!confirm('Tem certeza que deseja limpar toda a playlist?')) {
                console.log('‚ùå Cancelado pelo usu√°rio');
                return;
            }
            
            // Liberar URLs da mem√≥ria
            playlist.forEach(track => {
                if (track.url && !track.isExample) {
                    URL.revokeObjectURL(track.url);
                }
            });
            
            playlist = [];
            currentPlaylistIndex = 0;
            
            if (autoMixPlaylistActive) {
                stopAutoMixPlaylist();
            }
            
            renderPlaylist();
            updateAutoMixStatus();
            
            console.log('‚úÖ Playlist limpa');
            alert('‚úÖ Playlist limpa com sucesso!');
        }

        function removeFromPlaylist(index) {
            console.log(`üóëÔ∏è Removendo m√∫sica no √≠ndice ${index}`);
            
            if (index < 0 || index >= playlist.length) {
                console.error('‚ùå √çndice inv√°lido:', index);
                return;
            }
            
            const track = playlist[index];
            
            if (!confirm(`Remover "${track.title}" da playlist?`)) {
                console.log('‚ùå Remo√ß√£o cancelada pelo usu√°rio');
                return;
            }
            
            // Liberar URL da mem√≥ria
            if (track.url && !track.isExample) {
                URL.revokeObjectURL(track.url);
            }
            
            playlist.splice(index, 1);
            
            // Ajustar √≠ndice atual se necess√°rio
            if (currentPlaylistIndex >= index) {
                currentPlaylistIndex = Math.max(0, currentPlaylistIndex - 1);
            }
            
            renderPlaylist();
            updateAutoMixStatus();
            
            console.log(`‚úÖ M√∫sica removida: ${track.title}`);
        }

        function clearPlaylist() {
            if (confirm('Tem certeza que deseja limpar toda a playlist?')) {
                // Limpar URLs para liberar mem√≥ria
                playlist.forEach(track => {
                    if (track.url && !track.isExample) {
                        URL.revokeObjectURL(track.url);
                    }
                });
                playlist = [];
                currentPlaylistIndex = 0;
                renderPlaylist();
                updateAutoMixStatus();
                alert('‚úÖ Playlist limpa com sucesso!');
            }
        }

        function removeFromPlaylist(index) {
            if (confirm(`Remover "${playlist[index].title}" da playlist?`)) {
                // Liberar URL da mem√≥ria
                if (playlist[index].url && !playlist[index].isExample) {
                    URL.revokeObjectURL(playlist[index].url);
                }
                
                playlist.splice(index, 1);
                
                // Ajustar √≠ndice atual se necess√°rio
                if (currentPlaylistIndex >= index) {
                    currentPlaylistIndex = Math.max(0, currentPlaylistIndex - 1);
                }
                
                renderPlaylist();
                updateAutoMixStatus();
            }
        }

        function loadTrackToPlaylist(index) {
            console.log(`üìÅ Carregando arquivo para m√∫sica no √≠ndice ${index}`);
            
            if (index < 0 || index >= playlist.length) {
                console.error('‚ùå √çndice inv√°lido:', index);
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'audio/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                
                if (!file) {
                    console.log('‚ùå Nenhum arquivo selecionado');
                    return;
                }
                
                if (!file.type.startsWith('audio/')) {
                    console.log('‚ùå Arquivo n√£o √© de √°udio:', file.type);
                    alert('Por favor, selecione um arquivo de √°udio v√°lido.');
                    return;
                }
                
                console.log(`üéµ Carregando arquivo: ${file.name} para ${playlist[index].title}`);
                
                // Liberar URL anterior se existir
                if (playlist[index].url && !playlist[index].isExample) {
                    URL.revokeObjectURL(playlist[index].url);
                }
                
                const url = URL.createObjectURL(file);
                playlist[index].url = url;
                playlist[index].file = file;
                
                // Obter dura√ß√£o do arquivo
                const audio = new Audio(url);
                audio.addEventListener('loadedmetadata', () => {
                    const minutes = Math.floor(audio.duration / 60);
                    const seconds = Math.floor(audio.duration % 60);
                    playlist[index].duration = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    renderPlaylist();
                    console.log(`‚è±Ô∏è Dura√ß√£o obtida: ${playlist[index].duration}`);
                });
                
                audio.addEventListener('error', (e) => {
                    console.error('‚ùå Erro ao carregar √°udio:', file.name, e);
                    alert('Erro ao carregar o arquivo de √°udio. Tente novamente.');
                });
                
                audio.load();
                renderPlaylist();
                
                console.log(`‚úÖ Arquivo carregado para: ${playlist[index].title}`);
                alert(`‚úÖ Arquivo "${file.name}" carregado!`);
            };
            
            input.click();
        }

        function playTrackFromPlaylist(index) {
            console.log(`üéµ Tentando tocar m√∫sica no √≠ndice ${index}`);
            
            if (index < 0 || index >= playlist.length) {
                console.error('‚ùå √çndice inv√°lido:', index);
                return;
            }
            
            const track = playlist[index];
            
            if (!track.url || !track.file) {
                alert('Primeiro carregue um arquivo de √°udio para esta m√∫sica.');
                console.log('‚ùå M√∫sica n√£o tem arquivo carregado');
                return;
            }
            
            console.log(`üéµ Reproduzindo: ${track.title} - ${track.artist}`);
            
            currentPlaylistIndex = index;
            
            // Encontrar deck dispon√≠vel
            const availableDeck = getNextAvailableDeck();
            
            if (availableDeck) {
                console.log(`üéõÔ∏è Carregando no Deck ${availableDeck.deckNumber}`);
                
                // Usar a nova fun√ß√£o direta
                const success = loadTrackToDeckDirect(availableDeck.deckNumber, track.file);
                
                if (success) {
                    // Aguardar carregamento e tocar automaticamente
                    setTimeout(() => {
                        console.log('‚èØÔ∏è Auto-tocando ap√≥s carregamento...');
                        const playButton = document.getElementById(`play${availableDeck.deckNumber}`);
                        if (playButton) {
                            const icon = playButton.querySelector('i');
                            if (icon && icon.classList.contains('fa-play')) {
                                console.log(`üéµ Iniciando reprodu√ß√£o no Deck ${availableDeck.deckNumber}`);
                                playButton.click();
                                renderPlaylist();
                                updateAutoMixStatus();
                                console.log(`‚úÖ M√∫sica tocando no Deck ${availableDeck.deckNumber}`);
                            } else {
                                console.log('‚ÑπÔ∏è Deck j√° est√° tocando');
                            }
                        }
                    }, 1000);
                } else {
                    console.error('‚ùå Falha ao carregar arquivo');
                    alert('Erro ao carregar a m√∫sica no deck!');
                }
                
            } else {
                console.log('‚ùå Nenhum deck dispon√≠vel');
                alert('Todos os decks est√£o ocupados. Pare uma m√∫sica primeiro.');
            }
        }

        function getNextAvailableDeck() {
            console.log('üîç Procurando deck dispon√≠vel...');
            
            // M√©todo alternativo: usar diretamente os elementos HTML
            for (let i = 1; i <= 8; i++) {
                const playBtn = document.getElementById(`play${i}`);
                if (playBtn) {
                    const isPlaying = playBtn.querySelector('i').classList.contains('fa-pause');
                    if (!isPlaying) {
                        console.log(`‚úÖ Deck ${i} dispon√≠vel (via DOM)`);
                        currentDeck = i;
                        return { deckNumber: i, element: playBtn };
                    }
                }
            }
            
            // Se todos est√£o tocando, usar deck 1
            console.log('‚ö†Ô∏è Todos os decks ocupados, usando Deck 1');
            const deck1Btn = document.getElementById('play1');
            if (deck1Btn) {
                // Parar deck 1 clicando no bot√£o
                deck1Btn.click();
                setTimeout(() => {
                    currentDeck = 1;
                }, 100);
                return { deckNumber: 1, element: deck1Btn };
            }
            
            console.error('‚ùå Nenhum deck encontrado');
            return null;
        }

        // Fun√ß√£o alternativa para carregar m√∫sica diretamente no deck via DOM
        function loadTrackToDeckDirect(deckNumber, file) {
            console.log(`üìÅ Carregando arquivo diretamente no Deck ${deckNumber}`);
            
            const fileInput = document.getElementById(`file${deckNumber}`);
            if (!fileInput) {
                console.error(`‚ùå Input do Deck ${deckNumber} n√£o encontrado`);
                return false;
            }
            
            // Criar lista de arquivos fake
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            fileInput.files = dataTransfer.files;
            
            // Disparar evento change
            const event = new Event('change', { bubbles: true });
            fileInput.dispatchEvent(event);
            
            console.log(`‚úÖ Arquivo carregado no Deck ${deckNumber} via DOM`);
            return true;
        }

        // Fun√ß√£o de teste para verificar conectividade entre playlist e decks
        function testPlaylistIntegration() {
            console.log('üîß === TESTE DE INTEGRA√á√ÉO PLAYLIST ‚Üí DECKS ===');
            
            // Verificar playlist
            console.log('üìã Playlist atual:', playlist.length, 'm√∫sicas');
            if (playlist.length === 0) {
                console.log('‚ùå Playlist vazia - adicione m√∫sicas primeiro');
                return;
            }
            
            // Verificar decks
            for (let i = 1; i <= 8; i++) {
                const input = document.getElementById(`file${i}`);
                const playBtn = document.getElementById(`play${i}`);
                console.log(`üéõÔ∏è Deck ${i}:`, {
                    input: !!input,
                    playBtn: !!playBtn,
                    hasFile: input ? input.files.length > 0 : false
                });
            }
            
            // Testar primeira m√∫sica se dispon√≠vel
            if (playlist.length > 0 && playlist[0].file) {
                console.log('üéµ Testando primeira m√∫sica da playlist...');
                playTrackFromPlaylist(0);
            }
            
            console.log('üîß === FIM DO TESTE ===');
        }

        // Adicionar bot√£o de teste no console
        console.log('üîß Para testar a integra√ß√£o, execute: testPlaylistIntegration()');

        function loadFileToPickedDeck(file, deckNumber) {
            const deck = [deck1, deck2, deck3, deck4][deckNumber - 1];
            if (deck && file) {
                // Simular um evento de change do input file
                const fakeEvent = {
                    target: {
                        files: [file]
                    }
                };
                deck.loadFile(fakeEvent);
            }
        }

        function startAutoMixPlaylist() {
            if (!playlist.some(track => track.url)) {
                alert('Carregue pelo menos uma m√∫sica na playlist antes de iniciar o AutoMix.');
                return;
            }

            autoMixPlaylistActive = true;
            document.getElementById('startAutoMixBtn').disabled = true;
            document.getElementById('stopAutoMixBtn').disabled = false;
            
            const intervalTime = parseInt(document.getElementById('intervalTime').value) * 1000;
            
            updateAutoMixStatus();
            
            // Tocar a primeira m√∫sica
            playNextInPlaylist();
            
            // Configurar intervalo para pr√≥ximas m√∫sicas
            autoMixInterval = setInterval(() => {
                if (autoMixPlaylistActive) {
                    playNextInPlaylist();
                }
            }, intervalTime);

            console.log('AutoMix Playlist iniciado com intervalo de', intervalTime / 1000, 'segundos');
        }

        function stopAutoMixPlaylist() {
            autoMixPlaylistActive = false;
            
            if (autoMixInterval) {
                clearInterval(autoMixInterval);
                autoMixInterval = null;
            }
            
            document.getElementById('startAutoMixBtn').disabled = false;
            document.getElementById('stopAutoMixBtn').disabled = true;
            
            updateAutoMixStatus();
            console.log('AutoMix Playlist parado');
        }

        function playNextInPlaylist() {
            const mode = document.getElementById('playbackMode').value;
            const availableTracks = playlist.filter(track => track.url);
            
            if (availableTracks.length === 0) {
                stopAutoMixPlaylist();
                alert('Nenhuma m√∫sica carregada na playlist.');
                return;
            }
            
            let nextIndex;
            
            switch (mode) {
                case 'random':
                    const availableIndexes = playlist.map((track, index) => track.url ? index : -1).filter(i => i >= 0);
                    nextIndex = availableIndexes[Math.floor(Math.random() * availableIndexes.length)];
                    break;
                    
                case 'loop':
                    nextIndex = currentPlaylistIndex;
                    do {
                        nextIndex = (nextIndex + 1) % playlist.length;
                    } while (!playlist[nextIndex].url && nextIndex !== currentPlaylistIndex);
                    break;
                    
                default: // sequential
                    nextIndex = currentPlaylistIndex;
                    do {
                        nextIndex = (nextIndex + 1) % playlist.length;
                    } while (!playlist[nextIndex].url && nextIndex !== currentPlaylistIndex);
                    break;
            }
            
            if (playlist[nextIndex].url) {
                playTrackFromPlaylist(nextIndex);
            }
        }

        function updateAutoMixStatus() {
            const statusElement = document.getElementById('autoMixStatus');
            const nextTrackElement = document.getElementById('nextTrack');
            
            if (statusElement) {
                if (autoMixPlaylistActive) {
                    statusElement.className = 'badge bg-success';
                    statusElement.textContent = 'Ativo';
                } else {
                    statusElement.className = 'badge bg-secondary';
                    statusElement.textContent = 'Parado';
                }
            }
            
            if (nextTrackElement) {
                const nextIndex = (currentPlaylistIndex + 1) % playlist.length;
                const nextTrack = playlist.find(track => track.url);
                nextTrackElement.textContent = nextTrack ? `${nextTrack.title} - ${nextTrack.artist}` : 'Nenhuma';
            }
        }

        // Fun√ß√µes de Teste e Diagn√≥stico
        function testAudioContext() {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (AudioContext) {
                    const ctx = new AudioContext();
                    alert('‚úÖ Contexto de √°udio criado com sucesso!\nEstado: ' + ctx.state);
                    console.log('Audio Context:', ctx);
                    
                    // Tentar criar um oscilador
                    const oscillator = ctx.createOscillator();
                    const gainNode = ctx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(ctx.destination);
                    
                    oscillator.frequency.setValueAtTime(440, ctx.currentTime);
                    gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
                    
                    oscillator.start();
                    oscillator.stop(ctx.currentTime + 0.5);
                    
                    alert('‚úÖ Tom de teste de 440Hz reproduzido por 0.5s');
                } else {
                    alert('‚ùå Web Audio API n√£o suportada neste navegador');
                }
            } catch (error) {
                console.error('Erro ao testar contexto de √°udio:', error);
                alert('‚ùå Erro ao criar contexto de √°udio: ' + error.message);
            }
        }

        function generateTestTone(deckNumber) {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const ctx = new AudioContext();
                
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                // Frequ√™ncias diferentes para cada deck
                const frequencies = { 1: 440, 2: 523, 3: 659, 4: 784 };
                const frequency = frequencies[deckNumber] || 440;
                
                oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.2, ctx.currentTime);
                
                oscillator.start();
                oscillator.stop(ctx.currentTime + 1);
                
                console.log(`Tom de teste gerado para Deck ${deckNumber}: ${frequency}Hz`);
                alert(`üéµ Tom de teste reproduzido no Deck ${deckNumber} (${frequency}Hz)`);
                
            } catch (error) {
                console.error('Erro ao gerar tom de teste:', error);
                alert('‚ùå Erro ao gerar tom: ' + error.message);
            }
        }

        function checkSystemStatus() {
            // Verificar se os elementos existem antes de tentar usar
            const browserInfo = document.getElementById('browserInfo');
            const audioSupport = document.getElementById('audioSupport');
            const formatSupport = document.getElementById('formatSupport');
            
            if (browserInfo) {
                browserInfo.textContent = navigator.userAgent.split(')')[0] + ')';
            }
            
            // Suporte a √°udio
            const audioSupported = typeof Audio !== 'undefined';
            if (audioSupport) {
                audioSupport.innerHTML = audioSupported ? 
                    '<span class="text-success">‚úÖ Suportado</span>' : 
                    '<span class="text-danger">‚ùå N√£o Suportado</span>';
            }
            
            // Formatos suportados
            if (formatSupport && audioSupported) {
                const audio = new Audio();
                const formats = {
                    'MP3': 'audio/mpeg',
                    'WAV': 'audio/wav',
                    'OGG': 'audio/ogg',
                    'AAC': 'audio/aac',
                    'FLAC': 'audio/flac'
                };
                
                let formatList = '';
                for (const [name, type] of Object.entries(formats)) {
                    const support = audio.canPlayType(type);
                    const icon = support === 'probably' ? '‚úÖ' : support === 'maybe' ? '‚ö†Ô∏è' : '‚ùå';
                    formatList += `<small class="d-block">${icon} ${name}: ${support || 'n√£o suportado'}</small>`;
                }
                formatSupport.innerHTML = formatList;
            } else if (formatSupport) {
                formatSupport.innerHTML = '<small class="text-danger">√Åudio n√£o dispon√≠vel</small>';
            }
        }

        // FUN√á√ÉO DE TESTE PARA DEBUG
        function testPlaylistSystem() {
            console.log('üß™ === TESTE DO SISTEMA DE PLAYLIST ===');
            console.log('üìã Playlist atual:', playlist);
            console.log('üì¶ Container:', document.getElementById('playlistContainer'));
            console.log('üî¢ Counter:', document.getElementById('playlistCount'));
            
            // Testar adi√ß√£o manual
            const testTrack = {
                id: Date.now(),
                title: 'Teste M√∫sica',
                artist: 'Teste Artista',
                genre: 'Teste',
                duration: '3:45',
                url: '',
                file: null,
                isExample: false
            };
            
            playlist.push(testTrack);
            renderPlaylist();
            
            console.log('‚úÖ M√∫sica de teste adicionada');
            alert('üß™ Teste conclu√≠do! M√∫sica de teste adicionada √† playlist.');
        }

        // INICIALIZA√á√ÉO DO SISTEMA
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Inicializando Sistema de Playlist...');
            
            // Aguardar elementos DOM estarem prontos
            setTimeout(() => {
                try {
                    // Verificar se elementos essenciais existem
                    const container = document.getElementById('playlistContainer');
                    const counter = document.getElementById('playlistCount');
                    
                    if (!container) {
                        console.error('‚ùå Elemento playlistContainer n√£o encontrado!');
                        return;
                    }
                    
                    if (!counter) {
                        console.warn('‚ö†Ô∏è Elemento playlistCount n√£o encontrado');
                    }
                    
                    // Inicializar sistema
                    checkSystemStatus();
                    loadPlaylist();
                    updateAutoMixStatus();
                    
                    console.log('‚úÖ Sistema de Playlist inicializado com sucesso!');
                    console.log('üí° Para testar, digite no console: testPlaylistSystem()');
                    
                } catch (error) {
                    console.error('‚ùå Erro na inicializa√ß√£o:', error);
                }
            }, 1000);
        });

    </script>
</body>
</html>
